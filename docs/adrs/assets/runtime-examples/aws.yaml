apiVersion: infrastructuremanager.kyma-project.io/v1alpha1
kind: Runtime
metadata:
  labels:
    kyma-project.io/instance-id: instance-id
    kyma-project.io/runtime-id: runtime-id
    kyma-project.io/broker-plan-id: plan-id
    kyma-project.io/broker-plan-name: plan-name
    kyma-project.io/global-account-id: global-account-id
    kyma-project.io/subaccount-id: subAccount-id
    kyma-project.io/shoot-name: shoot-name
    kyma-project.io/region: region
    operator.kyma-project.io/kyma-name: kymaName
  name: runtime-id
  namespace: kcp-system
spec:
  shoot:
    # spec.shoot.name is set by the KEB, required
    name: shoot-name
    # spec.shoot.purpose is set by the KEB, required
    purpose: production
    # Will be modified by the SRE
    kubernetes:
      # spec.shoot.kubernetes.version is optional, when not provided default will be used
      version: "1.28.7"
      kubeAPIServer:
        ## spec.shoot.kubernetes.kubeAPIServer.oidcConfig is provided by the KEB, required
        oidcConfig:
          clientID: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
          groupsClaim: groups
          issuerURL: https://my.cool.tokens.com
          signingAlgs:
          - RS256
          usernameClaim: sub
        ## spec.shoot.kubernetes.kubeAPIServer.additionalOidcConfig is provided by the KEB, optional, not implemented in the first KIM release
        additionalOidcConfig:
          - clientID: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
            groupsClaim: groups
            issuerURL: https://some.others.tokens.com
            signingAlgs:
              - RS256
            usernameClaim: sub
            usernamePrefix: 'someother'
    ## spec.shoot.provider is provided by the KEB, required
    provider:
      type: aws
      region: eu-central-1
      # We must consider whether it makes sense to move HAP into KIM
      secretBindingName: "hypersaler secret"
    # spec.shoot.Networking is Provided by the KEB, required
    networking:
      pods: 100.64.0.0/12
      nodes: 10.250.0.0/16
      services: 100.104.0.0/13
    # spec.shoot.controlPlane is provided by the KEB, optional, default=nil
    controlPlane:
      highAvailability:
        failureTolerance:
          type: node
    workers:
      - machine:
          # spec.shoot.workers.machine.type provided by the KEB, required
          type: m6i.large
          # spec.shoot.workers.machine.image is optional, when not provider default will be used
          # Will be modified by the SRE
          image:
            name: gardenlinux
            version: 1312.3.0
        # spec.shoot.workers.volume is provided by the KEB, required for the first release
        # Probably can be moved into KIM, as it is hardcoded in KEB, and not dependent on plan
        volume:
          type: gp2
          size: 50Gi
        # spec.shoot.workers.zones is provided by the KEB, required
        zones:
          - eu-central-1a
          - eu-central-1b
          - eu-central-1c
        # spec.shoot.workers.name is provided by the KEB. Optional, if not provided default will be used
        name: cpu-worker-0
        # spec.shoot.workers.minimum is provided by the KEB, required
        minimum: 3
        # spec.shoot.workers.maximum is provided by the KEB, required
        maximum: 20
        # spec.shoot.workers.maxSurge is provided by the KEB, required in the first release.
        # It can be optional in the future, as it equals to zone count
        maxSurge: 3
        # spec.shoot.workers.maxUnavailable is provided by the KEB, required in the first release.
        # It can be optional in the future, as it is always set to 0
        maxUnavailable:  0
  security:
    networking:
      filter:
        # spec.security.networking.filter.egress.enabled is provided by the KEB, required
        egress:
          enabled: false
        # spec.security.networking.filter.ingress.enabled will be provided by the KEB, optional (default=false)
        ingress:
          enabled: true
    # spec.security.administrators is provided by the KEB, required
    administrators:
      - admin@myorg.com